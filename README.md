# HH API вариант 2

## Описание проекта

Программа позволяет получить данные о компаниях и вакансиях с сайта hh.ru, спроектировать таблицы в БД PostgreSQL и загрузить полученные данные в созданные таблицы.<br />
После записи данных в таблицы можно выгружать из них данные, используя соответствующие методы класса DBManager.

## Как загрузить данные

> Перед началом работы необходимо убедиться, что подключение к postgresql настроено.
> Создать в корне проекта файл database.ini и вписать в него:
> ```commandline
> [postgresql]
> host=<твой хост>
> user=<твой пользователь>
> password=<твой пароль>
> port=<твой порт>
> ```

1. Создать словарь **companies** с произвольным ключом (для наглядности - названием компании), в качестве значения указать id компании (тип **str**).
2. Раскомментировать и запустить
```commandline
hh_api = HhApi(companies)
hh_api.fetch_data()
```
для загрузки всех данных c АПИ.<br />
Закомментировать.<br />
_Данные записываются во временное хранилище: **data/temp/companies.json**_
3. Раскомментировать и запустить
```commandline
db_man.create_tables()
db_man.insert_data()
```
для создания БД, таблиц и записи в них данных.<br />
Закомментировать.

## Как работать с данными

Для работы с данными необходимо воспользоваться методами класса DBManager, используя уже созданный экземпляр.<br />

### _Методы DBManager_
get_companies_and_vacancies_count()
 — получает список всех компаний и количество вакансий у каждой компании.
 
get_all_vacancies()
 — получает список всех вакансий с указанием названия компании, названия вакансии и зарплаты и ссылки на вакансию.
 
get_avg_salary()
 — получает среднюю зарплату по вакансиям.
 
get_vacancies_with_higher_salary()
 — получает список всех вакансий, у которых зарплата выше средней по всем вакансиям.
 
get_vacancies_with_keyword('сторож')
 — получает список всех вакансий, в названии которых содержатся переданные в метод слова, например python.

_Все методы, кроме get_avg_salary(), возвращают список кортежей, который можно преобразовать так, как удобно лично тебе.
get_avg_salary() возвращает число (float)._